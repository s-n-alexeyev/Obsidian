## Установка Docker

В репозитории Ubuntu может быть не самая последняя версия Docker. По этому мы будем устанавливать его из официального репозитория Docker.

Сначала обновите существующий список пакетов:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>sudo apt update<br>```|

Затем установите несколько обязательных пакетов, которые позволяют `apt` использовать пакеты по HTTPS:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>sudo apt install apt-transport-https ca-certificates curl software-properties-common<br>```|

Добавляем ключ GPG официального репозитория Docker в вашу систему:

|   |   |
|---|---|
|```<br>1<br>2<br>3<br>```|```bash<br>sudo install -m 0755 -d /etc/apt/keyrings<br>sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc<br>sudo chmod a+r /etc/apt/keyrings/docker.asc<br>```|

Добавляем репозиторий Docker:

|   |   |
|---|---|
|```<br>1<br>2<br>3<br>4<br>```|```bash<br>echo \<br>  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \<br>  $(. /etc/os-release && echo "$VERSION_CODENAME") stable" \| \<br>  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null<br>```|

Обновляем список пакетов:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>sudo apt update<br>```|

Теперь надо убедится, что все нормально и установка будет из репозитория Docker, а не Ubuntu:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>apt-cache policy docker-ce<br>```|

На выходе видим плюс минус такую картину:

|   |   |
|---|---|
|```<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br>10<br>11<br>12<br>13<br>14<br>```|```bash<br>docker-ce:<br>  Installed: (none)<br>  Candidate: 5:26.1.1-1~ubuntu.24.04~noble<br>  Version table:<br>     5:26.1.1-1~ubuntu.24.04~noble 500<br>        500 https://download.docker.com/linux/ubuntu noble/stable amd64 Packages<br>     5:26.1.0-1~ubuntu.24.04~noble 500<br>        500 https://download.docker.com/linux/ubuntu noble/stable amd64 Packages<br>     5:26.0.2-1~ubuntu.24.04~noble 500<br>        500 https://download.docker.com/linux/ubuntu noble/stable amd64 Packages<br>     5:26.0.1-1~ubuntu.24.04~noble 500<br>        500 https://download.docker.com/linux/ubuntu noble/stable amd64 Packages<br>     5:26.0.0-1~ubuntu.24.04~noble 500<br>        500 https://download.docker.com/linux/ubuntu noble/stable amd64 Packages<br>```|

Если все так, то прекрасно! Установится откуда надо и все будет хорошо.

Ну и финальный штрих, установим Docker:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>sudo apt install docker-ce<br>```|

### Проверяем работает ли Docker

Для начала узнаел, что там с Docker’ом:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>sudo systemctl status docker<br>```|

На выходе:

|   |   |
|---|---|
|```<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br>10<br>11<br>```|```bash<br>● docker.service - Docker Application Container Engine<br>     Loaded: loaded (/lib/systemd/system/docker.service; enabled; vendor preset: enabled)<br>     Active: active (running) since Fri 2022-04-01 21:30:25 UTC; 22s ago<br>TriggeredBy: ● docker.socket<br>       Docs: https://docs.docker.com<br>   Main PID: 7854 (dockerd)<br>      Tasks: 7<br>     Memory: 38.3M<br>        CPU: 340ms<br>     CGroup: /system.slice/docker.service<br>             └─7854 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock<br>```|

Отлично! Все завелось и прекрасно работает. Давайте попробуем запустить какой нибудь контейнер:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>sudo docker run hello-world<br>```|

Если все хорошо, то на выходе увидим:

|   |   |
|---|---|
|```<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br>10<br>```|```bash<br>Unable to find image 'hello-world:latest' locally<br>latest: Pulling from library/hello-world<br>2db29710123e: Pull complete<br>Digest: sha256:bfea6278a0a267fad2634554f4f0c6f31981eea41c553fdf5a83e95a41d40c38<br>Status: Downloaded newer image for hello-world:latest<br><br>Hello from Docker!<br>This message shows that your installation appears to be working correctly.<br><br>...<br>```|

### Разрешаем не root пользователю запускать Docker

По умолчанию обычные пользователи не могут запускать докер без использования `sudo`, но все поправимо.

Лучше не стоит

Никогда так не делайте на продакшине! Это практически выдача рутовых прав пользователю

Добавляем своего пользователя в группу `docker`:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>sudo usermod -aG docker ${USER}<br>```|

Перелогиваемся и смело выполняем:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>docker run hello-world<br>```|

## Устанавливаем Docker-compose

Запускаем эту команду для установки последней версии docker-compose, проверить какая версия является последней можно [тут](https://github.com/docker/compose/releases):

|   |   |
|---|---|
|```<br>1<br>2<br>```|```bash<br>mkdir -p ~/.docker/cli-plugins/<br>curl -SL https://github.com/docker/compose/releases/download/v2.27.0/docker-compose-linux-x86_64 -o ~/.docker/cli-plugins/docker-compose<br>```|

Делаем файл запускаемым:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>chmod +x ~/.docker/cli-plugins/docker-compose<br>```|

При желании можно настроить [автодополнение](https://docs.docker.com/compose/completion/) команды для `bash` или `zsh`.

Проверяем, как все работает:

|   |   |
|---|---|
|```<br>1<br>```|```bash<br>docker compose version<br>```|

Увидим плюс минус:

|                 |                                                  |
| --------------- | ------------------------------------------------ |
| ```<br>1<br>``` | ```bash<br>Docker Compose version v2.27.0<br>``` |